<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="../css/styles.css">
<link rel="icon" href="../img/icono-intranet.png">
</head>
<body>
  <!-- Navbar -->
<div id="navbar-container">
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold text-primary" href="dashboard.html">Intranet</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="dashboard.html">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" href="gproductos.html">Gestión de Productos</a></li>
          <li class="nav-item"><a class="nav-link" href="pedidos.html">Pedidos</a></li>
          <li class="nav-item"><a class="nav-link" href="mensajes.html">Mensajes</a></li>
          <li class="nav-item"><a class="nav-link" href="usuarios.html">Usuarios</a></li>
          <li class="nav-item"><a class="nav-link" href="../index.html">Cerrar Sesión</a></li>
        </ul>
      </div>
    </div>
  </nav>
</div>

<div class="container py-5">
  <h1>Bienvenido, <span id="nombre-admin">Trabajador</span></h1>

  <!-- Pedidos recientes -->
  <section class="my-4">
    <h3><a href="pedidos.html" class="link">Pedidos recientes</a></h3>
    <div id="dashboard-pedidos" class="mb-4 row"></div>
  </section>

  <!-- Usuarios recientes -->
  <section class="my-4">
    <h3>
      <a href="usuarios.html" class="link">Usuarios recientes</a>
    </h3>
    <div id="dashboard-usuarios" class="mb-4 row"></div>
  </section>

  <!-- Mensajes recientes -->
  <section class="my-4">
    <h3><a href="mensajes.html" class="link">Mensajes recientes</a></h3>
    <div id="dashboard-mensajes" class="mb-4 row"></div>
  </section>

  <!-- Productos recientes -->
  <section class="my-4">
    <h3><a href="gproductos.html" class="link">Productos añadidos recientemente</a></h3>
    <div id="dashboard-productos" class="mb-4 row"></div>
  </section>

  <button id="btn-cerrar-sesion" class="btn btn-success rounded-pill">Cerrar sesión</button>
</div>

<!-- Footer -->
<footer class="text-center py-4 text-white" style="background-color: #FFACCA;">
  <div class="mb-2">
    <a href="#" class="mx-2"><img src="../img/instagram.svg" style="width:28px;"></a>
    <a href="#" class="mx-2"><img src="../img/facebook.svg" style="width:28px;"></a>
    <a href="#" class="mx-2"><img src="../img/paypal.svg" style="width:28px;"></a>
  </div>
  <p class="mb-0">&copy; 2025 LovelyY5 - Todos los derechos reservados</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Dashboard JS
document.addEventListener('DOMContentLoaded', () => {
  const nombreAdmin = localStorage.getItem('adminNombre') || 'Trabajador';
  document.getElementById('nombre-admin').textContent = nombreAdmin;

  // Cerrar sesión
  document.getElementById('btn-cerrar-sesion').addEventListener('click', () => {
    if(confirm('¿Deseas cerrar sesión?')) {
      localStorage.removeItem('adminLogin');
      localStorage.removeItem('adminNombre');
      window.location.href = '../index.html';
    }
  });

  // Pedidos recientes (últimos 5)
  const pedidos = JSON.parse(localStorage.getItem('pedidos')) || [];
  const pedidosDiv = document.getElementById('dashboard-pedidos');
  pedidosDiv.innerHTML = '';
  pedidos.slice(-5).reverse().forEach(p => {
    const div = document.createElement('div');
    div.className = 'col-12';
    div.innerHTML = `<div class="card p-2 mb-2">
      <strong>${p.nombres} ${p.apellidos}</strong> - $${p.total} - <em>${p.email}</em>
      <ul class="list-unstyled mb-0">
        ${p.productos.map(prod => `<li>${prod.nombre} x${prod.cantidad}</li>`).join('')}
      </ul>
    </div>`;
    pedidosDiv.appendChild(div);
  });

    // Usuarios recientes (últimos 5)
  const usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];
  const usuariosDiv = document.getElementById('dashboard-usuarios');
  usuariosDiv.innerHTML = '';

  usuarios.slice(-5).reverse().forEach(u => {
    const div = document.createElement('div');
    div.className = 'col-md-4 mb-2';
    div.innerHTML = `<div class="card p-2">
      <strong>${u.nombre}</strong> (${u.categoria})<br>
      <em>${u.email}</em><br>
      <span>${u.telefono}</span>
    </div>`;
    usuariosDiv.appendChild(div);
  });


  // Mensajes recientes (últimos 5)
  const mensajes = JSON.parse(localStorage.getItem('mensajes')) || [];
  const mensajesDiv = document.getElementById('dashboard-mensajes');
  mensajesDiv.innerHTML = '';
  mensajes.slice(-5).reverse().forEach(msg => {
    const div = document.createElement('div');
    div.className = 'col-12';
    div.innerHTML = `<div class="card p-2 mb-2">
      <strong>${msg.nombre}</strong> - <em>${msg.email}</em>
      <p>${msg.mensaje}</p>
    </div>`;
    mensajesDiv.appendChild(div);
  });

  // Productos recientes (últimos 5)
  const productos = JSON.parse(localStorage.getItem('productos')) || [];
  const productosDiv = document.getElementById('dashboard-productos');
  productosDiv.innerHTML = '';
  productos.slice(-5).reverse().forEach(p => {
    const div = document.createElement('div');
    div.className = 'col-md-4';
    div.innerHTML = `<div class="card p-2 mb-2 d-flex align-items-center">
      <img src="img/${p.imagenes?.[0] || 'default.png'}" class="card-img-top mb-2" style="max-width:100px;">
      <strong>${p.nombre}</strong> - $${p.precio}
    </div>`;
    productosDiv.appendChild(div);
  });
});
</script>
<script src="js/pedidos.js"></script>
</body>
</html>
